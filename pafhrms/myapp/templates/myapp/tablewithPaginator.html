
     <table class="table table-responsive-sm table-bordered table-striped table-sm">
      <tr>
          <th>RANK</th>
          <th>AFPSN</th>
          <th>FULL NAME</th>
          <th>UNIT</th>
          <th>SUB-UNIT</th>
          <th>PME</th>
          <th>untanche</th>
          <th>ACTION</th>
      </tr>
      {% for person in persons %}
      <tr>
        <td>{{ person.RANK }}</td>
        <td>{{ person.SERIAL_NUMBER }}</td>
        <td>{{ person.FIRST_NAME}} {{person.MIDDLE_NAME}} {{person.LAST_NAME}}</td>
        <td>{{ person.UNIT }}</td>
        <td>{{ person.SUB_UNIT }}</td>
        <td>{{ person.HIGHEST_PME_COURSES }}</td>
        <td>{{ person.DATE_FIRST_TRANCHE_REENLISTMENT }}</td>

        <!-- <td><button class="btn btn-primary" id="openModalButton"  class="count_btn">EDIT</button></td> -->
        
        <td>
        <button 
                class="btn btn-primary openModalButton" 
                data-rank="{{ person.RANK }}"
                data-lastname="{{ person.LAST_NAME }}"
                data-firstname="{{ person.FIRST_NAME }}"
                data-middlename="{{ person.MIDDLE_NAME }}"
                data-suffix="{{ person.EXTENSION_NAME }}"
                data-afpsn="{{ person.SERIAL_NUMBER }}"
                data-unit="{{ person.UNIT }}"
                data-subunit="{{ person.SUB_UNIT }}"
                data-birthday="{{ person.BIRTHDAY }}"
                data-contactnumber="{{ person.CONTACT_NUMBER }}"
                data-sex="{{ person.SEX }}"
                data-address="{{ person.ADDRESS }}"
                data-classification="{{ person.CLASSIFICATION }}"
                data-sourceofenlistmentcommission="{{ person.SOURCE_OF_ENLISTMENT_COMMISION }}"
                data-category="{{ person.CATEGORY }}"
                data-afsc="{{ person.AFSC }}"
                data-hpme="{{ person.HIGHEST_PME_COURSES }}"
                data-dateenteredmilitary="{{ person.EFFECTIVE_DATE_ENTERED }}"
                data-lengthofservice="{{ person.LENGTH_OF_SERVICE }}"
                data-dateofcommissionship="{{ person.EFFECTIVE_DATE_APPOINTMENT }}"
                data-promotion="{{ person.DATE_LAST_PROMOTION_APPOINTMENT }}"

                data-unaTranche="{{ person.DATE_FIRST_TRANCHE_REENLISTMENT }}"
                data-dosTranche="{{ person.DATE_SECOND_TRANCHE_REENLISTMENT }}"
                data-dateoflastetadsot="{{ person.DATE_SECOND_TRANCHE_REENLISTMENT }}"
                data-pilotrating="{{ person.PILOT_RATED_NON_RATED }}"


                data-toggle="modal"
                data-target="#myModal">EDIT</button>
        </td>

    </tr>
      {% endfor %}
  </table>

  {% include 'modals/updateModal.html' %}
  
 <script>

  

  

$(document).ready(function() {
    $('.openModalButton').click(function() {
        var rank = $(this).data('rank');
        var lastname = $(this).data('lastname');
        var firstname = $(this).data('firstname');
        var middlename = $(this).data('middlename');
        var suffix = $(this).data('suffix');
        if (suffix === "nan") {
          suffix= '';
            }
        var afpsn = $(this).data('afpsn');
        var unit = $(this).data('unit');
        var subunit = $(this).data('subunit');
        var birthday = $(this).data('birthday');
        var contactnum = $(this).data('contactnumber');
        if (contactnum === "None") {
          contactnum= '';
            }
        var sex = $(this).data('sex');
        var address = $(this).data('address');
        var classification = $(this).data('classification');
        var sourceofenlistmentcommission = $(this).data('sourceofenlistmentcommission');

        var category = $(this).data('category');
        var afsc = $(this).data('afsc');
        if (afsc === "nan") {
          afsc= '';
            }
            
        var hpme = $(this).data('hpme');
        var dateenteredmilitary = $(this).data('dateenteredmilitary');
        var dateoflastpromotion = $(this).data('datelastpromotion');
        var lengthofservice = $(this).data('lengthofservice');
        var dateofcommissionship = $(this).data('dateofcommissionship');
        var promotion = $(this).data('promotion');

        var dateoflastetadsot = $(this).data('dateoflastetadsot');
        var unaTranche = $(this).data('unaTranche');
        var dosTranche = $(this).data('dosTranche');
        var pilotrating = $(this).data('pilotrating');

        

// POPULATING DATA TO MODAL 
        $('#ranktxt').val(rank);
        $('#lastnametxt').val(lastname);
        $('#firstnametxt').val(firstname);
        $('#middlenametxt').val(middlename);
        $('#suffixtxt').val(suffix);
        $('#afpsntxt').val(afpsn);
        $('#unittxt').val(unit);
        $('#subunittxt').val(subunit);
        $('#bdaytxt').val(birthday);
        $('#contactnumtxt').val(contactnum);
        $('#sextxt').val(sex);
        $('#addresstxt').val(address);
        $('#categorytxt').val(category);
        $('#classificationtxt').val(classification);
        $('#sourceofenlistmentcommissiontxt').val(sourceofenlistmentcommission);
        $('#afsctxt').val(afsc);
        $('#hpmetxt').val(hpme);
        // $('#DOLetadsottxt').val(hpme);  
        $('#enlistmentdatetxt').val(dateenteredmilitary);
        $('#promotiontxt').val(dateoflastpromotion);
        $('#lengthofservicetxt').val(lengthofservice);
        $('#dateofcommissionshiptxt').val(dateofcommissionship);
        $('#promotiontxt').val(promotion);
        $('#dateoflastetadsottxt').val(dateoflastetadsot);
        $('#unaTranchetxt').val(unaTranche);
        $('#dosTranchetxt').val(dosTranche);
        $('#pilotratingtxt').val(pilotrating);

        
        if (category === "ENLISTED PERSONNEL") {
          $('#commission_enlistment_lbl').text('Date of Enlistment');
          $('#dateoflastetadsottxt').hide();
          $('#dateoflastetadsotlbl').hide();
          $('#unaTranchelbl').show();
          $('#unaTranchetxt').show();
          $('#dosTranchelbl').show();
          $('#dosTranchetxt').show();
          $('#pilotratingtxt').hide();
          $('#pilotratinglbl').hide();
          $('#classificationtxt').hide();
          $('#classificationlbl').hide();
          

        // } else if(category === "OFFICER") {
        } else{

          $('#commission_enlistment_lbl').text('Date of Commission');
          $('#unaTranchelbl').hide();
          $('#unaTranchetxt').hide();
          $('#dosTranchelbl').hide(); 
          $('#dosTranchetxt').hide();
          $('#pilotratinglbl').show();
          $('#pilotratingtxt').show();
          $('#classificationlbl').show();
          $('#classificationtxt').show();


          $('#dateoflastetadsottxt').show();
          $('#dateoflastetadsotlbl').show();
            // $('#unaTranchelbl').hide();
            // $('#dosTranchetxt').hide();  
            // $('#dosTranchelbl').hide();  
            // $('#dosTranchetxt').hide();  
        }
   
        

        
        // $('#firstnametxt').val(unit);
    });
});








// function calculateLengthOfService(startDate) {
//     // Split the start date into parts
//     var startDateParts = startDate.replace(',', '').split(' ');
//     var startMonth = getMonthNumber(startDateParts[0]);
//     var startDay = parseInt(startDateParts[1], 10);
//     var startYear = parseInt(startDateParts[2], 10);
    

//     // Create Date objects for the start and current dates
//     var startDateFormatted = new Date(startYear, startMonth, startDay);
//     var currentDate = new Date();


//     // Calculate the difference in time
//     var differenceInTime = currentDate.getTime() - startDateFormatted.getTime();
//     console.log(differenceInTime)

//     // Calculate the differences in years, months, and days
//     var years = currentDate.getFullYear() - startDateFormatted.getFullYear();
//     var months = currentDate.getMonth() - startDateFormatted.getMonth();
//     var days = currentDate.getDate() - startDateFormatted.getDate();



//     // Adjust for cases where months or days are negative
//     if (months < 0 || (months === 0 && days < 0)) {
//         years--;
//         months += 12;
//     }
//     if (days < 0) {
//         var prevMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 0);
//         days += prevMonth.getDate();
//         months--;
//     }

//     // Return the length of service as an object
//     return {
//         years: years,
//         months: months,
//         days: days
//     };
// }

// // Helper function to get month number from month name
// function getMonthNumber(monthString) {
//     var months = {
//         "Jan": 0, "Feb": 1, "Mar": 2, "Apr": 3, "May": 4, "Jun": 5,
//         "Jul": 6, "Aug": 7, "Sep": 8, "Oct": 9, "Nov": 10, "Dec": 11
//     };
//     return months[monthString];
// }

// // Function to update length of service textbox
// function updateLengthOfService() {
//     var enlistmentDate =  "Dec 31, 2020";
//     var lengthOfService = calculateLengthOfService(enlistmentDate);
//     $("#lengthofservicetxt").val(lengthOfService.years + " years, " + lengthOfService.months + " months, " + lengthOfService.days + " days");
// }

// console.log("hey")
// updateLengthOfService()


//  document.body.addEventListener('click', function(event) {
//   if (event.target && event.target.id === 'openModalButton') {
//     $('#myModal').modal('show');
    

//   }
// });




  </script>



  <div class="pagination">
    <span class="step-links">
        {% if persons.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ persons.previous_page_number }}">previous</a>
        {% endif %}
        <span class="current">
            Page {{ persons.number }} of {{ persons.paginator.num_pages }}
        </span>
        {% if persons.has_next %}
            <a href="?page={{ persons.next_page_number }}">next</a>
            <a href="?page={{ persons.paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
  </div>
