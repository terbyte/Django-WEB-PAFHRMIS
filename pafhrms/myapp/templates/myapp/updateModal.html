  


  </style>
<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="myModalLabel">Update Information</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <div class="modal-body">
        <form id="updateForm" method="post">
          {% csrf_token %}
          <input type="hidden" id="personnel_id" name="personnel_id">

                <div class="container mt-4">
                    <!-- Row 1: 4 columns of textboxes -->
                    <div class="row">
                      <div class="col-md-4">
                      <label for="lastnametxt">Last Name</label>
                      <input type="text" id="lastnametxt" name="last_name" class="form-control" placeholder="Last Name" readonly>
                    </div>
                    <div class="col-md-3">
                      <label for="firstnametxt">First Name</label>
                      <input type="text" id="firstnametxt" name="first_name" class="form-control" placeholder="First Name" readonly>
                    </div>
                    <div class="col-md-3">
                      <label for="middlenametxt">Middle Name</label>
                      <input type="text" id="middlenametxt" name="middle_name" class="form-control" placeholder="Middle Name" readonly>
                    </div>
                      <div class="col-md-2">
                        <label for="textbox1">Suffix</label>
                        <input type="text" id="Suffix" class="form-control" placeholder="Suffix" disabled>
                      </div>
                    </div>
                    
                    <!-- Row 2: 5 columns of textboxes -->
                    <div class="row mt-3">
                      <div class="col-md-2">
                        <label for="textbox1">AFPSN</label>
                        <input type="text" id="afpsntxt" class="form-control" placeholder="AFPSN" disabled>
                      </div>
                      <div class="col-md-3">
                        <label for="sextxt">Sex</label>
                        <input type="text"  id="sextxt" class="form-control" placeholder="Sex" disabled>
                      </div>
                      <div class="col-md-2">
                        <label for="textbox1">Birthday</label>
                        <input type="text"  id="bdaytxt" class="form-control" placeholder="Birthday" disabled>
                      </div>
                      <div class="col-md-3">
                        <label for="textbox1">Classification</label>
                        <input type="text" id="Classificationtxt"  class="form-control" placeholder="Classification" disabled>
                      </div>
                      <div class="col-md-2">
                        <label for="textbox1">Category</label>
                        <input type="text" id="cateorytxt"  class="form-control" placeholder="Category" disabled>
                      </div>
                      
                      

                    </div>
                    
                    <!-- Row 3: 4 columns of textboxes -->
                    <div class="row mt-3">
                      
                      <div class="col-md-3">
                        <label for="textbox1">Date Of Commssionship</label>
                        <input type="text" id="dateofcommissionshiptxt"  class="form-control" placeholder="Date of commissionship" disabled>
                      </div>
                      
                      <div class="col-md-3">
                        <label for="textbox1">Source of Commission</label>
                        <input type="text"  id="sourcecommissiontxt" class="form-control" placeholder="Source of commission" disabled>
                      </div>
                      <div class="col-md-3">
                        <label for="textbox1">Date Entered to Military Service</label>
                        
                        <input type="text" id="enlistmentdatetxt"  class="form-control" placeholder="Date Entered to Military Service" disabled>
                      
                      </div>
                      <div class="col-md-3">
                        <label for="textbox1">Length Of Service</label>
                        <input type="text" id="lengthofservicetxt"  class="form-control" placeholder="Length of service" disabled>
                      </div>
                    </div>
                  </div>

                  <div class="container mt-4">
                    <!-- Row 1: 4 columns of textboxes -->
                    <div class="row">
                      <div class="col-md-12">
                        <label for="addresstxt">Address</label>
                        <input type="text"  id="addresstxt" class="form-control" name="address" placeholder="Address">
                      </div>

                    
                    </div>
                    
                    <!-- Row 2: 5 columns of textboxes -->
                    <div class="row mt-3">
                      <div class="col-md-2">
                        <label for="ranktxt">Rank</label>
                        <input type="text"  id="ranktxt" name = "rank" class="form-control" >

                        <!-- <select id="ranktxt" name = 'rank 'id="ranktxt" class="form-control">
                          <option selected>Rank</option>
                          <optgroup label="Officer">
                            <option value="GEN">GEN</option>
                            <option value="LTGEN">LTGEN</option>
                            <option value="BGEN">BGEN</option>
                            <option value="COL">COL</option>
                            <option value="LTC">LTC</option>
                            <option value="MAJ">MAJ</option>
                            <option value="CPT">CPT</option>
                            <option value="1LT">1LT</option>
                            <option value="2LT">2LT</option>
                          </optgroup>
                          <optgroup label="Enlisted Personnel">
                            <option value="CMSgt">CMSgt</option>
                            <option value="SMSgt">SMSgt</option>
                            <option value="MSgt">MSgt</option>
                            <option value="TSg">TSg</option>
                            <option value="SSg">SSg</option>
                            <option value="Sgt">Sgt</option>
                            <option value="A1C">A1C</option>
                            <option value="AW1C">AW1C</option>
                            <option value="A2C">A2C</option>
                            <option value="AW2C">AW2C</option>
                            <option value="AM">AM</option>
                            <option value="AW">AW</option>
                          </optgroup>
                        </select> -->
                      </div>
                      <div class="col-md-2">
                        <label for="afsctxt">AFSC</label>
                        <input type="text"  id="afsctxt" name="afsc"  class="form-control" placeholder="AFSC">
                      </div>
                      <div class="col-md-4">
                        <label >Unit</label>
                        <select for="unitDP" id="unitDP" name="unit" class="form-control">
                        <option selected>UNIT</option>
                        <option>GHQ</option>
                        <option>HPAF</option>
                        <option>PAFHRMC-A/U</option>
                        <option>AFPWSSUS</option>
                        <option>AIBDC</option>
                        <option>ADC</option>
                        <option>AMC</option>
                        <option>ACC</option>
                        <option>AETDC</option>
                        <option>ARFC</option>
                        <option >TOWNOL</option>
                        <option >TOWSOL</option>
                        <option >TOWCEN</option>
                        <option >TOWWEST</option>
                        <option >TOWEASTMIN</option>
                        <option >TOWWESTMIN</option>
                        <option >355AEW</option>
                        <option >300AISW</option>
                        <option >900AFWG</option>
                        <option >950CEWW</option>
                        <option >AFFC</option>
                        <option >AFSSG</option>
                        <option >HSSG</option>
                        <option >PAFCMOG</option>
                        <option >PAFHRMC</option>
                        <option >NOLCOM</option>
                        <option >SOLCOM</option>
                        <option >WESCOM</option>
                        <option >VISCOM</option>
                        <option >WESTMINCOM</option>
                        <option >EASTMINCOM</option>
                        <option >JTF-NCR</option>
                        </select>

                      </div>


                      <div class="col-md-4">
                        <label>Sub Unit</label>

                        <select for="SubunitDP" id="SubunitDP"  name="subunit" class="form-control">
                        <option selected>SUB UNIT</option>

                      </select>
                      </div>
                      

                    </div>  
                    <!-- Row 3: 4 columns of textboxes -->
                    <div class="row mt-3">
                      
                      <div class="col-md-3">
                        <label for="promotiontxt">Date of Last Promotion</label>
                        <!-- <input type="text"  id="promotiontxt" class="form-control" placeholder="Date of last promotion"> -->
                        <input type="text" name="promotion" id="promotiontxt" class="form-control">

                      </div>
                      <div class="col-md-3">
                        <label for="hpmetxt">Highest PME</label>
                        <input type="text" name="hpme"  id="hpmetxt" class="form-control" placeholder="Highest PME">
                      </div>
                      <div class="col-md-3">
                        <label for="dateoflastetadsot">Date Of Last ETAD/SOT</label>
                        <input type="text" name="dateoflastetadsot" id="dateoflastetadsot" class="form-control">
                        

                      </div>

                      <div class="col-md-3">

                      <label for="contactnumtxt">Contact Number</label>
                        <input type="text" name="contactnum" id="contactnumtxt"  oninput="validateNumberInput(this)" class="form-control" maxlength="11" placeholder="e.g 09123456789" >
                      </div>
                      

                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                  <button type="submit" class="btn btn-primary">Save changes</button>
            </form>
        </div>
      </div>
    </div>
  </div>


  <script>
    function validateNumberInput(input) {
            // Remove any non-digit characters
            input.value = input.value.replace(/\D/g, '');
           
        }




    $(document).ready(function() {
      $('.openModalButton').click(function() {
          var personnelId = $(this).data('afpsn'); // Assuming 'afpsn' is the unique identifier
          $('#personnel_id').val(personnelId);
          $('#addresstxt').val($(this).data('address'));
          // $('#lastnametxt').val($(this).data('lastname'));
          // $('#firstnametxt').val($(this).data('firstname'));
          // $('#middlenametxt').val($(this).data('middlename'));
          $('#ranktxt').val($(this).data('rank'));
          $('#afsctxt').val($(this).data('afsc'));
          $('#unitDP').val($(this).data('unit'));
          $('#SubunitDP').val($(this).data('subunit'));
          $('#contactnumtxt').val($(this).data('contactnum'));
          $('#hpmetxt').val($(this).data('hpme'));
          // $('#promotiontxt').val($(this).data('promotion'));
          
      });




  
      $('#updateForm').submit(function(event) {
          event.preventDefault();
          
          var formData = $(this).serialize();
          var csrfToken = $('input[name="csrfmiddlewaretoken"]').val();
  
          $.ajax({
              url: '{% url "update_personnel" %}',
              method: 'POST',
              data: formData,
              headers: {
                  'X-CSRFToken': csrfToken
              },
              success: function(response) {
                  if (response.success) {
                      console.log('Data updated successfully!');
                      
                      location.reload(); // Reload page or update UI as needed
                  } else {
                      console.error('Error updating data:', response.error);
                  }
              },
              error: function(xhr, status, error) {
                  console.error('Error updating data:', error);
              }
          });
      });
  });


  // Object mapping units to their respective subunits
  const unitSubunitMap = {
            'HPAF': ['OCG', 'OVC', 'OCAS', 'OSAS', 'AFCC', 'OAFIG', 'OSS', 'AFSO', 'OESPA',
            'AFSMO', 'AFPAO', 'OAFIA', 'OAFSM', 'OAFA', 'OAFPM', 'OAJA', 'OCAC',
            'OCSAF', 'OCAFDS', 'OCNAF', 'OAFCE', 'OCHCA', 'AFREO', 'AFIMAO',
            'AFCLOAC', 'OAFGAD', 'ACOFAS, A-1', 'ACOFAS, A-2', 'ACOFAS, A-3',
            'ACOFAS, A-4', 'ACOFAS, A-5', 'ACOFAS, A-6', 'ACOFAS, A-7', 'ACOFAS, A-8',
            'ACOFAS, A-9', 'ACOFAS, A-10'],
            'AIBDC':  ['HAIBDC', '520th ABG', '530th ABG', '540th ABG', '550th ABG',
            '560th ABG', '585th ABG', '590th ABG', '600ABG', '970th HECG',
            'AFGH', '1301st DD'],
            'ADC': ['HADC', '5FW', '580ACWW', '960AMDG', 'PADCC', 'ADAC'],
            'AMC':['HAMC', '205THW', '220AW', '250PAW', '505SRG'],
            'ACC': ['HACC', '15SW', '710SPOW'],
            'AETDC': [ 'HAETDC', 'PAFOS', 'PAFOCS', 'PAFFS', 'PAFNCOS', 'PAFTSS',
            'PAFBMS', 'PAFLTC', 'PAFALEN', '440AMG', 'TDC', 'AWC'],
            'ARFC': ['HAFRC', '1ARCEN', '2ARCEN', '3ARCEN', '4ARCEN', '5ARCEN', '6ARCEN', '7ARCEN', '8ARCEN'],
            'PAFHRMC-A/U': [],
            'GHQ': ['OJ1', 'OJ2', 'OJ3', 'OJ4', 'OJ5', 'OJ6', 'OJ7', 'OJ8', 'OJ9', 'OJ10', 'AFPCC','OTAG', 'OTPMG', 'OTCCHS', 'OTJAG', 'AFPPDO', 'OTQMG', 'OTSG', 'AFPSEO','AFPHRO', 'OTCN', 'OTCDS', 'OSPS', 'AFPIMAC', 'AFPREO', 'AFPEBSO', 'OTCE','AFP K9', 'AFPCOC', 'CEISO', 'CGEASH', 'OAFPSM', 'GHQTS', 'PMO', 'OSJA','ODCOP', 'ONAF', 'GHQPFO'],
            'AFPWSSUS': ['PMA', 'AFPETDC', 'CEISSAFP', 'CRSAFP', 'ISAFP', 'AFPHSC', 'AFP SOCOM', 'AFPFC', 'AFPPS', 'AFPPKOC', 'AFPCES', 'AFPMCC', 'PSG', 'AFPPGMC', 'AFPCYBER', 'AFPRESCOM', 'DND'],

          };

        // Get the dropdown elements 
        const unitDP = document.getElementById('unitDP');
        const SubunitDP = document.getElementById('SubunitDP');

        // Event listener for unit dropdown change
        unitDP.addEventListener('change', function() {
            // Get selected unit
            const selectedUnit = unitDP.value;

            // Clear previous subunit options
            SubunitDP.innerHTML = '<option value="">--Select Subunit--</option>';

            // If a valid unit is selected, populate subunits
            if (selectedUnit) {
                const subunits = unitSubunitMap[selectedUnit];
                subunits.forEach(function(subunit) {
                    const option = document.createElement('option');
                    option.value = subunit;
                    option.textContent = subunit;
                    SubunitDP.appendChild(option);
                });
            }
        });




        

  </script>